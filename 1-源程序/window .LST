C51 COMPILER V9.00   WINDOW_                                                               04/22/2020 14:27:46 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE WINDOW_
OBJECT MODULE PLACED IN window .OBJ
COMPILER INVOKED BY: D:\KEIL4\C51\BIN\C51.EXE window .c BROWSE DEBUG OBJECTEXTEND

line level    source

   1          
   2          #include <reg52.h>//¿âº¯Êý
   3          #include <dht11.h> //¿âº¯Êý//Èç¹û ÊµÎï ´ò¿ª
   4          #include <adc0832.h> //AD×ª»»¿âº¯Êý
   5          #include "eeprom52.h"
   6          
   7          #define uchar unsigned char//ºê¶¨Òâ
   8          #define uint  unsigned int//ºê¶¨Òâ
   9          #define ulong unsigned long     //ºê¶¨Òâ
  10          bit s=1;
  11          #define NULL 0
  12          #define RsBuf_N                 150
  13          
  14          unsigned char xdata RsBuf[RsBuf_N];     //¶¨Òå´®¿Ú½ÓÊÕÊý¾Ý»º³åÇø
  15          uchar RsPoint;
  16          
  17          sbit rs=P2^5;//LCD 1602 Òý½Å¶¨Òâ                
  18          sbit rd=P2^6;//LCD 1602 Òý½Å¶¨Òâ                
  19          sbit lcden=P2^7;//LCD 1602 Òý½Å¶¨Òâ
  20          sbit menu=P2^0; //Ö÷¹¦ÄÜ¼ü      
  21          sbit add=P2^1;//¼Ó¼ü            
  22          sbit dec=P2^2;// ¼õ¼ü
  23          sbit open=P2^3;// ÊÖ¶¯ ¿ª
  24          sbit close=P2^4;// ÊÖ¶¯ ¹Ø       
  25          
  26          sbit IR=P3^6; //ºìÍâ¸Ð Ó¦
  27          sbit BEEP=P3^4;// ·äÃùÆ÷±¨¾¯
  28          #define MOTORSTEP P1                    //ºê¶¨Òå£¬¶¨ÒåP1¿ÚÎª²½½øµç»úÇý¶¯¶Ë¿Ú
  29          
  30          uchar kval,con;// ¸÷ÖÖ±äÁ¿±ê¼Ç
  31          uchar second;//Ê±ÖÓ±äÁ¿
  32          bit dsflj,opensw,closesw,befl,menusw,lofl,zhenzhuan,fanzhuan,keysw;     
  33          uint adc0,adc1;
  34          uchar dwbrig,kwbrig,uphum,uptemp,upsmo; // ÏÂÏÞ ÁÁ¶È ÉÏÏÞÊª¶È// ÉÏÏÞÎÂ¶È
  35          
  36          uchar   U8T_data_H,U8RH_data_H;
  37          
  38          char dianhuahaoma[12]; //½ÓÊÕºÅÂë£¨Ö»¿ÉÒÔÓÃÒÆ¶¯»òÕßÁªÍ¨µÄºÅÂë£¬²åÔÚÄ£¿éÉÏµÄ¿¨Ò²±ØÐëÊÇÒÆ¶¯»òÕßÁªÍ¨£¬¾ÍÊÇ²»Ä
             -ÜÓÃµçÐÅ£©
  39          
  40          uchar code somebody[]           ="8BF76CE8610FFF0C67094EBA8FDB5165FF01";        //Çë×¢Òâ£¡ÓÐÈË½øÈë£¡£¨·¢ËÍ¶ÌÐÅÄÚÈÝµÄ±àÂë£©
  41          
  42          bit jishi=1;
  43          bit ZD_SD_MODE=0;
  44          bit flag_celiang=0;
  45          
  46          #define Imax 14000    //´Ë´¦Îª¾§ÕñÎª11.0592Ê±µÄÈ¡Öµ, 
  47          #define Imin 8000    //ÈçÓÃÆäËüÆµÂÊµÄ¾§ÕñÊ±,
  48          #define Inum1 1450    //Òª¸Ä±äÏàÓ¦µÄÈ¡Öµ¡£
  49          #define Inum2 700 
  50          #define Inum3 3000 
  51          
  52          uchar f=0;
  53          uchar Im[4]={0x00,0x00,0x00,0x00}; // Ò£¿ØÂë´æ´¢¿Õ¼ä
  54          uchar show[2]={0,0};  // ±äÁ¿ÉêÃ÷
C51 COMPILER V9.00   WINDOW_                                                               04/22/2020 14:27:46 PAGE 2   

  55          ulong m,Tc;       // ±äÁ¿ÉêÃ÷
  56          uchar IrOK;             // ±äÁ¿ÉêÃ÷
  57          
  58          void delay(uint z);// ¿ª´°Ê±¼ä±äÁ¿
  59          
  60          void write_rvalue(); // ÏÔÊ¾º¯Êý
  61          //**************ÒÔÏÂÊÇ¸÷ÖÖ×ÖÄ»ÌáÊ¾ÓïÊý×é************************
  62          uchar code logo1[]= "Welcome to use  ";
  63          uchar code logo2[]= "Window   system ";
  64          uchar code logo3[]= "S:    H:  %     ";
  65          uchar code logo4[]= "L:    T:  C     ";
  66          uchar code logo5[]= "Window Opening  ";
  67          uchar code logo6[]= "Window Closing  ";
  68          uchar code logo7[]= "L-CLOSE:   LUX  ";
  69          uchar code logo8[]= "H-Hum :    %    ";
  70          uchar code logo9[]= "Please press +/-";
  71          uchar code logo10[]="Please wait...  ";
  72          uchar code logo11[]="H-Tem :    C    ";
  73          uchar code logo15[]="H-Smoke:        ";
  74          uchar code logo16[]="L-OPEN :   LUX  ";
  75          
  76          uchar code logo17[]=" Sending SMS    ";
  77          
  78          void delaymoto()                                        //²½½øµç»úÃ¿Ò»²½¼äÑÓ³Ùº¯Êý
  79          {       
  80   1              uint y=200;
  81   1              while(y--);
  82   1      }
  83          
  84          uchar code FFW[]={0x01,0x03,0x02,0x06,0x04,0x0c,0x08,0x09}; //²½½øµç»úÇý¶¯ÖµÊý×é
  85          uchar code REV[]={0x09,0x08,0x0c,0x04,0x06,0x02,0x03,0x01}; //²½½øµç»úÇý¶¯ÖµÊý×é
  86          
  87          //uchar num1 [4] =    {0x00,0x00,0x00,0x00,};                           
  88          //uchar num2 [4] =    {0x00,0x00,0x00,0x00,};                    
  89          //uchar num3 [4] =    {0x00,0x00,0x00,0x00,};              
  90          uchar num4 [4] =    {0x00,0x00,0x00,0x00,};     // AD×ª»»±äÁ¿×é×é
  91          //uchar num5 [4] =    {0x00,0x00,0x00,0x00,};   // AD×ª»»±äÁ¿×é×é
  92          
  93          /******************°ÑÊý¾Ý±£´æµ½µ¥Æ¬»úÄÚ²¿eepromÖÐ******************/
  94          void write_eeprom()
  95          {
  96   1              SectorErase(0x2000);
  97   1              byte_write(0x2000, uptemp);
  98   1              byte_write(0x2001, uphum);
  99   1              byte_write(0x2002, dwbrig);
 100   1              byte_write(0x2003, kwbrig);
 101   1              byte_write(0x2004, upsmo);
 102   1      
 103   1              byte_write(0x2005, dianhuahaoma[0]);
 104   1              byte_write(0x2006, dianhuahaoma[1]);
 105   1              byte_write(0x2007, dianhuahaoma[2]);
 106   1              byte_write(0x2008, dianhuahaoma[3]);
 107   1              byte_write(0x2009, dianhuahaoma[4]);
 108   1              byte_write(0x200a, dianhuahaoma[5]);
 109   1              byte_write(0x200b, dianhuahaoma[6]);
 110   1              byte_write(0x200c, dianhuahaoma[7]);
 111   1              byte_write(0x200d, dianhuahaoma[8]);
 112   1              byte_write(0x200e, dianhuahaoma[9]);
 113   1              byte_write(0x200f, dianhuahaoma[10]);
 114   1      
 115   1              byte_write(0x2060, a_a);        
 116   1      }
C51 COMPILER V9.00   WINDOW_                                                               04/22/2020 14:27:46 PAGE 3   

 117          
 118          /******************°ÑÊý¾Ý´Óµ¥Æ¬»úÄÚ²¿eepromÖÐ¶Á³öÀ´*****************/
 119          void read_eeprom()
 120          {
 121   1              uptemp= byte_read(0x2000);
 122   1              uphum= byte_read(0x2001);
 123   1              dwbrig= byte_read(0x2002);
 124   1              kwbrig= byte_read(0x2003);
 125   1              upsmo= byte_read(0x2004);
 126   1      
 127   1              dianhuahaoma[0]=byte_read(0x2005);
 128   1              dianhuahaoma[1]=byte_read(0x2006);
 129   1              dianhuahaoma[2]=byte_read(0x2007);
 130   1              dianhuahaoma[3]=byte_read(0x2008);
 131   1              dianhuahaoma[4]=byte_read(0x2009);
 132   1              dianhuahaoma[5]=byte_read(0x200a);
 133   1              dianhuahaoma[6]=byte_read(0x200b);
 134   1              dianhuahaoma[7]=byte_read(0x200c);
 135   1              dianhuahaoma[8]=byte_read(0x200d);
 136   1              dianhuahaoma[9]=byte_read(0x200e);
 137   1              dianhuahaoma[10]=byte_read(0x200f);
 138   1      
 139   1              a_a      = byte_read(0x2060);
 140   1      }
 141          
 142          /**************¿ª»ú×Ô¼ìeeprom³õÊ¼»¯*****************/
 143          void init_eeprom() 
 144          {
 145   1              read_eeprom();          //ÏÈ¶Á
 146   1              if(a_a != 1)            //ÐÂµÄµ¥Æ¬»ú³õÊ¼µ¥Æ¬»úÄÚÎÊeeprom
 147   1              {
 148   2                      a_a = 1;
 149   2                      uptemp=33; //ÎÂ¶ÈÉÏÏÞ
 150   2                      uphum=60;        //Êª¶ÈÉÏÏÞ
 151   2                      dwbrig=30;//¹â¿ØÏÂÏÞ
 152   2                      kwbrig=180;     //¿ª´°¹âÏß
 153   2                      upsmo=85;       //ÑÌÎíÉÏÏÞÖµ
 154   2      
 155   2                      dianhuahaoma[0]=0;
 156   2                      dianhuahaoma[1]=0;
 157   2                      dianhuahaoma[2]=0;
 158   2                      dianhuahaoma[3]=0;
 159   2                      dianhuahaoma[4]=0;
 160   2                      dianhuahaoma[5]=0;
 161   2                      dianhuahaoma[6]=0;
 162   2                      dianhuahaoma[7]=0;
 163   2                      dianhuahaoma[8]=0;
 164   2                      dianhuahaoma[9]=0;
 165   2                      dianhuahaoma[10]=0;
 166   2      
 167   2                      write_eeprom();    //±£´æÊý¾Ý
 168   2              }       
 169   1      }
 170          
 171          void delay(uint z)//ÑÓÊ±º¯Êý
 172          {
 173   1              uint x,y;
 174   1              for(x=z;x>0;x--)
 175   1                      for(y=110;y>0;y--);
 176   1      }
 177          
 178          void delay_1602(uint z)//ÑÓÊ±º¯Êý
C51 COMPILER V9.00   WINDOW_                                                               04/22/2020 14:27:46 PAGE 4   

 179          {
 180   1              uint x,y;
 181   1              for(x=z;x>0;x--)
 182   1                      for(y=10;y>0;y--);
 183   1      }
 184          
 185          void SETP_MOTOR_FFW()    //·´×ª
 186          {
 187   1              uint i=0;
 188   1              for(i=0;i<8;i++) //8²½Ò»¸öÑ­»·
 189   1              {
 190   2                      MOTORSTEP=FFW[i]; //È¡Öµ¸³¸øP1Çý¶¯¿Ú
 191   2                      delaymoto(); 
 192   2              }
 193   1       }
 194          
 195          void SETP_MOTOR_REV()  //Õý×ª
 196          {
 197   1          uint i=0;
 198   1              for(i=0;i<8;i++) //8²½Ò»¸öÑ­»·
 199   1              {
 200   2                      MOTORSTEP=REV[i]; //È¡Öµ¸³¸øP1Çý¶¯¿Ú
 201   2                      delaymoto(); 
 202   2              }
 203   1      }
 204          
 205          void write_com(uchar com) //LCD 1602 Ð´Ö¸Áî
 206          {
 207   1              rs=0;
 208   1              lcden=0;
 209   1              P0=com;
 210   1              delay_1602(5);
 211   1              lcden=1;
 212   1              delay_1602(5);
 213   1              lcden=0;        
 214   1      }
 215          
 216          void write_date(uchar date)//LCD 1602 Ð´Êý¾Ý
 217          {
 218   1              rs=1;
 219   1              lcden=0;
 220   1              P0=date;
 221   1              delay_1602(5);
 222   1              lcden=1;
 223   1              delay_1602(5);
 224   1              lcden=0;        
 225   1      }
 226          
 227          void write_string(uchar a_b,uchar *p)
 228          { 
 229   1              if(a_b!=0)
 230   1              write_com(a_b);
 231   1              while(*p!='\0')
 232   1              {
 233   2                      write_date(*p);
 234   2                      p++;
 235   2              }
 236   1      }
 237          
 238          void init1602()//LCD 1602 ³õÊ¼»¯
 239          {
 240   1              uchar num;
C51 COMPILER V9.00   WINDOW_                                                               04/22/2020 14:27:46 PAGE 5   

 241   1              rd=0;
 242   1              lcden=0;
 243   1              write_com(0x38);
 244   1              write_com(0x0c);
 245   1              write_com(0x06);
 246   1              write_com(0x01);
 247   1              write_com(0x80);
 248   1              for(num=0;num<16;num++)
 249   1              {
 250   2                      write_date(logo1[num]);//¿ª»ú×ÖÄ»
 251   2              }
 252   1              write_com(0x80+0x40);
 253   1              for(num=0;num<16;num++)
 254   1              {
 255   2                      write_date(logo2[num]); //¿ª»ú×ÖÄ»
 256   2              }
 257   1      }
 258          
 259          void keyscn()//°´¼üÉ¨Ãèº¯Êý
 260          {
 261   1              uchar num; //¾Ö²¿±äÁ¿
 262   1              if(kval==0)       //Ã»ÓÐ½øÈëÉèÖÃ×´Ì¬Ê±
 263   1              {
 264   2                      if(add==0||(IrOK==1&&Im[2]==0x15))              //¼Ó°´¼üÊÇÊÖ¶¯×Ô¶¯ÇÐ»»°´¼ü
 265   2                      {
 266   3                              delay(20);
 267   3                              if(add==0||(IrOK==1&&Im[2]==0x15))
 268   3                              {
 269   4                                      BEEP=0;
 270   4                                      delay(50);
 271   4                                      BEEP=1;
 272   4                                      Im[2]=0x00;
 273   4                                      ZD_SD_MODE=!ZD_SD_MODE;
 274   4                                      write_com(0x80+0x40+13);
 275   4                                      if(ZD_SD_MODE==0)                //µÈÓÚ0ÊÇ×Ô¶¯
 276   4                                      {
 277   5                                              write_date('Z');
 278   5                                              write_date('D');
 279   5                                              write_date(' ');        
 280   5                                      }                               
 281   4                                      else
 282   4                                      {
 283   5                                              write_date('S');
 284   5                                              write_date('D');
 285   5                                              write_date(' ');        
 286   5                                      }
 287   4                                      while(add==0);
 288   4                              }
 289   3                      }
 290   2                      if(dec==0||(IrOK==1&&Im[2]==0x0d))
 291   2                      {
 292   3                              delay(20);
 293   3                              if(dec==0||(IrOK==1&&Im[2]==0x0d))
 294   3                              {
 295   4                                      BEEP=0;
 296   4                                      delay(50);
 297   4                                      BEEP=1;
 298   4                                      Im[2]=0x00;
 299   4                                      befl=0;                  //¹Ø±Õ±¨¾¯
 300   4                                      BEEP=1; 
 301   4                                      while(dec==0);
 302   4                              }
C51 COMPILER V9.00   WINDOW_                                                               04/22/2020 14:27:46 PAGE 6   

 303   3                      }
 304   2              }
 305   1              if(ZD_SD_MODE==1)       //ÊÖ¶¯Ä£Ê½
 306   1              {
 307   2                      if(keysw==1)       //ÔÊÐíÊÖ¶¯¿ª¹Ø´°
 308   2                      {
 309   3                              if(closesw==1)     //¹Ø±Õ×´Ì¬Ê±
 310   3                              {
 311   4                                      if(open==0||(IrOK==1&&Im[2]==0x09))      // ÊÖ¶¯¿ª´°°´¼ü°´ÏÂ
 312   4                                      {                                   
 313   5                                          delay(20);
 314   5                                              if(open==0||(IrOK==1&&Im[2]==0x09))
 315   5                                              {
 316   6                                                      BEEP=0;
 317   6                                                      delay(50);
 318   6                                                      BEEP=1;
 319   6                                                      write_com(0x80);
 320   6                                                      for(num=0;num<16;num++)//ÏÔÊ¾¿ª´°ÌáÊ¾Óï
 321   6                                                      {
 322   7                                                              write_date(logo5[num]);
 323   7                                                      }
 324   6                                                      write_com(0x80+0x40);
 325   6                                                      for(num=0;num<16;num++)//ÏÔÊ¾ÌáÊ¾Óï
 326   6                                                      {
 327   7                                                              write_date(logo10[num]);
 328   7                                                      }
 329   6                                                      Im[2]=0x00;
 330   6                                                      
 331   6                                                      zhenzhuan=0;// Õý×ª ¿ªÆô
 332   6                                                      fanzhuan=1;      // ·´×ª¹Ø±Õ
 333   6                                                      second=0;// ÃëÇåÁã ²½½øµç»ú »áÍ£
 334   6                                                      jishi=1;
 335   6                                                      keysw=0;  //½ûÖ¹ÊÖ¶¯¿ª¹Ø´°
 336   6                                                      menusw=0; //ÊÖ¶¯¿ªÊ¼ÔËÐÐ£¬ÇåÁã
 337   6                                                      while(!open);
 338   6                                              }        
 339   5                                      }
 340   4                                      if(adc0>upsmo)
 341   4                                      {
 342   5                                              befl=1;  
 343   5                                              BEEP=0;
 344   5                                              delay(50);
 345   5                                              BEEP=1;
 346   5                                              write_com(0x80);
 347   5                                              for(num=0;num<16;num++)//ÏÔÊ¾¿ª´°ÌáÊ¾Óï
 348   5                                              {
 349   6                                                      write_date(logo5[num]);
 350   6                                              }
 351   5                                              write_com(0x80+0x40);
 352   5                                              for(num=0;num<16;num++)//ÏÔÊ¾ÌáÊ¾Óï
 353   5                                              {
 354   6                                                      write_date(logo10[num]);
 355   6                                              }
 356   5                                              Im[2]=0x00;
 357   5                                              
 358   5                                              zhenzhuan=0;// Õý×ª ¿ªÆô
 359   5                                              fanzhuan=1;      // ·´×ª¹Ø±Õ
 360   5                                              second=0;// ÃëÇåÁã ²½½øµç»ú »áÍ£
 361   5                                              jishi=1;
 362   5                                              keysw=0;  //½ûÖ¹ÊÖ¶¯¿ª¹Ø´°
 363   5                                              menusw=0; //ÊÖ¶¯¿ªÊ¼ÔËÐÐ£¬ÇåÁã
 364   5                                      }
C51 COMPILER V9.00   WINDOW_                                                               04/22/2020 14:27:46 PAGE 7   

 365   4                              }
 366   3                              if(opensw==1)//Èç¹û´°»§ÊÇ´ò¿ªµÄ
 367   3                              {
 368   4                                      if(close==0||(IrOK==1&&Im[2]==0x07))//°´ÏÂÊÖ¶¯¹Ø
 369   4                                      {
 370   5                                          delay(20);
 371   5                                              if(close==0||(IrOK==1&&Im[2]==0x07))
 372   5                                              {
 373   6                                                      BEEP=0;
 374   6                                                      delay(50);
 375   6                                                      BEEP=1;
 376   6                                                      write_com(0x80);
 377   6                                                      for(num=0;num<16;num++)//ÏÔÊ¾ÌáÊ¾Óï
 378   6                                                      {
 379   7                                                              write_date(logo6[num]);
 380   7                                                      }
 381   6                                                      write_com(0x80+0x40);
 382   6                                                      for(num=0;num<16;num++)
 383   6                                                      {
 384   7                                                              write_date(logo10[num]);//ÏÔÊ¾ÌáÊ¾Óï
 385   7                                                      }
 386   6                                                      Im[2]=0x00;
 387   6                                                      zhenzhuan=1;  //Õý×ª¹Ø
 388   6                                                      fanzhuan=0;     // ·´×ª ¿ªÆô
 389   6                                                      second=0;       // ¶¨Ê±ÇåÁã
 390   6                                                      jishi=1;
 391   6                                                      keysw=0; // ½ûÖ¹ÊÖ¶¯¿ª¹Ø´°
 392   6                                                      menusw=0;       //ÊÖ¶¯¿ªÊ¼ÔËÐÐ£¬ÇåÁã
 393   6                                                      while(!close);
 394   6                                              }        
 395   5                                      } 
 396   4                                      if(adc0>upsmo)
 397   4                                      befl=1;         
 398   4                              }
 399   3                      }
 400   2              }
 401   1      
 402   1              if(menusw==1)//Èç¹û´°»§ÔËÐÐÍê±Ï
 403   1              {
 404   2                      if(menu==0||(IrOK==1&&Im[2]==0x47))// Èç¹ûÖ÷¹¦ÄÜ¼ü°´ÏÂ
 405   2                      {
 406   3                          delay(20);  //ÑÓÊ±Ïû¶¶¶¯
 407   3                              if(menu==0||(IrOK==1&&Im[2]==0x47))
 408   3                              {
 409   4                                      BEEP=0;
 410   4                                      delay(50);
 411   4                                      BEEP=1;
 412   4                                      Im[2]=0x00;
 413   4                                      dsflj=0;// ¹ØÖ÷Ò³ÏÔÊ¾
 414   4                                      kval++; // °´¼ü±äÁ¿++  ÉèÖÃ²»Í¬µÄÖµ
 415   4                                      keysw=0;//²»ÔÊÐíÊÖ¶¯ ¿ª´°  ºÍ¹Ø´°
 416   4                                      befl=0;
 417   4                                      lofl=1; //×ÖÄ»Ö»ÐèÒªÔØÈëÒ»´Î
 418   4                                      write_eeprom();                    //±£´æÊý¾Ý
 419   4                                      while(!menu);//ËÉÊÖ¼ì²â
 420   4                              }
 421   3                      } 
 422   2      
 423   2      //*************************************************************************8
 424   2              
 425   2                      
 426   2               //**************************ÒÔÏÂ ÁÁ¶È»áÉÏÉè¶¨  ºÍÉÏÃæÐ¡Ê±Ò»Ñù
C51 COMPILER V9.00   WINDOW_                                                               04/22/2020 14:27:46 PAGE 8   

 427   2               //Ö»ÊÇ¾ÍÁ¿²»Ò»Ñù ²»×÷×¢ÊÍ*******************************************
 428   2               //**************
 429   2              
 430   2              
 431   2                //********************************Éè¶¨»·¾³²ÎÊý************************************
 432   2                      if(kval==1)
 433   2                      {       
 434   3      //                      write_com(0x0d);
 435   3                              num4[4]=dwbrig;
 436   3                              write_rvalue();
 437   3                              if(lofl==1)
 438   3                              {
 439   4                                      write_com(0x80);
 440   4                                      for(num=0;num<16;num++)
 441   4                                      {
 442   5                                              write_date(logo7[num]);
 443   5                                      }
 444   4                              
 445   4                                      write_com(0x80+0x40);
 446   4                                      for(num=0;num<16;num++)
 447   4                                      {
 448   5                                              write_date(logo9[num]);
 449   5                                              lofl=0;
 450   5                                      }
 451   4                              }
 452   3                          if(add==0||(IrOK==1&&Im[2]==0x40))  
 453   3                              {
 454   4                                      delay(20);          
 455   4                                      if(add==0||(IrOK==1&&Im[2]==0x40))
 456   4                                      {
 457   5                                              BEEP=0;
 458   5                                              delay(50);
 459   5                                              BEEP=1;
 460   5                                              Im[2]=0x00;
 461   5                                              while(!add);                                                            
 462   5                                               dwbrig++;
 463   5                                               num4[4]=dwbrig;
 464   5                                               write_rvalue();
 465   5                                       if(dwbrig>=kwbrig)
 466   5                                       {dwbrig=kwbrig-1;}
 467   5                                       }
 468   4                              } 
 469   3                      
 470   3                              if(dec==0||(IrOK==1&&Im[2]==0x19))      
 471   3                              {
 472   4                                      delay(20); 
 473   4                                      if(dec==0||(IrOK==1&&Im[2]==0x19))
 474   4                                      {
 475   5                                              BEEP=0;
 476   5                                              delay(50);
 477   5                                              BEEP=1;
 478   5                                              Im[2]=0x00;
 479   5                                              while(!dec);                                                            
 480   5                                              dwbrig--;
 481   5                                              num4[4]=dwbrig;
 482   5                                              write_rvalue(); 
 483   5                                      if(dwbrig<1)
 484   5                                      {dwbrig=0;}
 485   5                                      }
 486   4                              } 
 487   3                      }
 488   2              //*********************************************************************
C51 COMPILER V9.00   WINDOW_                                                               04/22/2020 14:27:46 PAGE 9   

 489   2              
 490   2              
 491   2                 //********************************Éè¶¨»·¾³²ÎÊý************************************
 492   2               
 493   2                      else if(kval==2)
 494   2                      {
 495   3                              
 496   3      //                      write_com(0x0d);
 497   3                              num4[4]=kwbrig;
 498   3                              write_rvalue();
 499   3                              if(lofl==1)
 500   3                              {
 501   4                                      write_com(0x80);
 502   4                                      for(num=0;num<16;num++)
 503   4                                      {
 504   5                                              write_date(logo16[num]);
 505   5                                      }
 506   4                                      write_com(0x80+0x40);
 507   4                                      for(num=0;num<16;num++)
 508   4                                      {
 509   5                                              write_date(logo9[num]);
 510   5                                              lofl=0;
 511   5                                      }
 512   4                              }
 513   3                          if(add==0||(IrOK==1&&Im[2]==0x40))  
 514   3                              {
 515   4                                      delay(20);
 516   4                                      if(add==0||(IrOK==1&&Im[2]==0x40))
 517   4                                      {
 518   5                                              BEEP=0;
 519   5                                              delay(50);
 520   5                                              BEEP=1;
 521   5                                              Im[2]=0x00;
 522   5                                              while(!add);                                                            
 523   5                                              kwbrig++;
 524   5                                              num4[4]=kwbrig;
 525   5                                              write_rvalue();
 526   5              
 527   5                                      if(kwbrig>=255)
 528   5                                      {kwbrig=255;}
 529   5                                      }
 530   4                              } 
 531   3                              if(dec==0||(IrOK==1&&Im[2]==0x19))      
 532   3                              {
 533   4                                      delay(20);
 534   4                                      if(dec==0||(IrOK==1&&Im[2]==0x19))
 535   4                                      {
 536   5                                              BEEP=0;
 537   5                                              delay(50);
 538   5                                              BEEP=1;
 539   5                                              Im[2]=0x00;
 540   5                                              while(!dec);                                                            
 541   5                                              kwbrig--;
 542   5                                              num4[4]=kwbrig;
 543   5                                              write_rvalue();
 544   5                                      if(kwbrig<=dwbrig)
 545   5                                      {kwbrig=dwbrig+1;}
 546   5                                      }
 547   4                              } 
 548   3                      }
 549   2              
 550   2               //**************************ÒÔÏÂ Êª¶È»áÉÏÉè¶¨  ºÍÉÏÃæÐ¡Ê±Ò»Ñù
C51 COMPILER V9.00   WINDOW_                                                               04/22/2020 14:27:46 PAGE 10  

 551   2               //Ö»ÊÇ¾ÍÁ¿²»Ò»Ñù ²»×÷×¢ÊÍ*******************************************
 552   2               //**************               
 553   2                      else if(kval==3)
 554   2                      {
 555   3                              num4[4]=uphum;
 556   3                              write_rvalue();
 557   3                              if(lofl==1)
 558   3                              {
 559   4                                      write_com(0x80);
 560   4                                      for(num=0;num<16;num++)
 561   4                                      {
 562   5                                              write_date(logo8[num]);
 563   5                                      }
 564   4                                      write_com(0x80+0x40);
 565   4                                      for(num=0;num<16;num++)
 566   4                                      {
 567   5                                              write_date(logo9[num]);
 568   5                                              lofl=0;
 569   5                                      }
 570   4                              }
 571   3                          if(add==0||(IrOK==1&&Im[2]==0x40))  
 572   3                              {
 573   4                                      delay(20); 
 574   4                                      if(add==0||(IrOK==1&&Im[2]==0x40))
 575   4                                      {
 576   5                                              BEEP=0;
 577   5                                              delay(50);
 578   5                                              BEEP=1;
 579   5                                              Im[2]=0x00;
 580   5                                              while(!add);                                                            
 581   5                                              uphum++;
 582   5                                              num4[4]=uphum;
 583   5                                              write_rvalue();
 584   5                                      if(uphum>=95)
 585   5                                      {uphum=95;}
 586   5                                       }
 587   4                              }
 588   3                              if(dec==0||(IrOK==1&&Im[2]==0x19))      
 589   3                              {
 590   4                                      delay(20);
 591   4                                      if(dec==0||(IrOK==1&&Im[2]==0x19))
 592   4                                      {
 593   5                                              BEEP=0;
 594   5                                              delay(50);
 595   5                                              BEEP=1;
 596   5                                              Im[2]=0x00;
 597   5                                              while(!dec);                                                            
 598   5                                              uphum--;
 599   5                                              num4[4]=uphum;
 600   5                                              write_rvalue();
 601   5                                      if(uphum<=5)
 602   5                                      {uphum=5;}
 603   5                                       }
 604   4                              } 
 605   3                      }
 606   2               //**************************ÒÔÏÂ ÎÂ¶È¶È»áÉÏÉè¶¨  ºÍÉÏÃæÐ¡Ê±Ò»Ñù
 607   2               //Ö»ÊÇ¾ÍÁ¿²»Ò»Ñù ²»×÷×¢ÊÍ*******************************************
 608   2               //**************                               
 609   2                      else if(kval==4)
 610   2                      {
 611   3                              num4[4]=uptemp;
 612   3                              write_rvalue();
C51 COMPILER V9.00   WINDOW_                                                               04/22/2020 14:27:46 PAGE 11  

 613   3                              if(lofl==1)
 614   3                              {
 615   4                                      write_com(0x80);
 616   4                                      for(num=0;num<16;num++)
 617   4                                      {
 618   5                                              write_date(logo11[num]);
 619   5                                      }
 620   4                                      write_com(0x80+0x40);
 621   4                                      for(num=0;num<16;num++)
 622   4                                      {
 623   5                                              write_date(logo9[num]);
 624   5                                              lofl=0;
 625   5                                      }
 626   4                              }
 627   3                              if(add==0||(IrOK==1&&Im[2]==0x40))      
 628   3                              {
 629   4                                      delay(20);                          
 630   4                                      if(add==0||(IrOK==1&&Im[2]==0x40))
 631   4                                      {
 632   5                                              BEEP=0;
 633   5                                              delay(50);
 634   5                                              BEEP=1;
 635   5                                              Im[2]=0x00;
 636   5                                              while(!add);                                                            
 637   5                                              uptemp++;
 638   5                                              num4[4]=uptemp;
 639   5                                              write_rvalue();
 640   5                                      if(uptemp>=60)
 641   5                                      {uptemp=0;}
 642   5                                       }
 643   4                              } 
 644   3                              if(dec==0||(IrOK==1&&Im[2]==0x19))      
 645   3                              {
 646   4                                      delay(20);
 647   4                                      if(dec==0||(IrOK==1&&Im[2]==0x19))
 648   4                                      {
 649   5                                              BEEP=0;
 650   5                                              delay(50);
 651   5                                              BEEP=1;
 652   5                                              Im[2]=0x00;
 653   5                                              while(!dec);                                                            
 654   5                                              uptemp--;
 655   5                                              num4[4]=uptemp;
 656   5                                              write_rvalue();
 657   5                                      if(uptemp<=0)
 658   5                                      {uptemp=0;}
 659   5                                      }
 660   4                              } 
 661   3                      }
 662   2              
 663   2               //**************************ÒÔÏÂÑÌÎí¶È»áÉÏÉè¶¨  ºÍÉÏÃæÐ¡Ê±Ò»Ñù
 664   2               //Ö»ÊÇ¾ÍÁ¿²»Ò»Ñù ²»×÷×¢ÊÍ*******************************************
 665   2               //**************                               
 666   2                      else if(kval==5)
 667   2                      {
 668   3                              num4[4]=upsmo;
 669   3                              write_rvalue();
 670   3                              if(lofl==1)
 671   3                              {
 672   4                                      write_com(0x80);
 673   4                                      for(num=0;num<16;num++)
 674   4                                      {
C51 COMPILER V9.00   WINDOW_                                                               04/22/2020 14:27:46 PAGE 12  

 675   5                                              write_date(logo15[num]);
 676   5                                      }
 677   4                                      write_com(0x80+0x40);
 678   4                                      for(num=0;num<16;num++)
 679   4                                      {
 680   5                                              write_date(logo9[num]);
 681   5                                              lofl=0;
 682   5                                      }
 683   4                              }
 684   3                          if(add==0||(IrOK==1&&Im[2]==0x40))  
 685   3                              {
 686   4                                      delay(20);
 687   4                                      if(add==0||(IrOK==1&&Im[2]==0x40))
 688   4                                      {
 689   5                                              BEEP=0;
 690   5                                              delay(50);
 691   5                                              BEEP=1;
 692   5                                              Im[2]=0x00;
 693   5                                              while(!add);                                                            
 694   5                                              upsmo++;
 695   5                                              num4[4]=upsmo;
 696   5                                              write_rvalue();
 697   5                                      if(upsmo>=255)
 698   5                                      {upsmo=0;}
 699   5                                      }
 700   4                              } 
 701   3                              if(dec==0||(IrOK==1&&Im[2]==0x19))      
 702   3                              {
 703   4                                      delay(20);
 704   4                                      if(dec==0||(IrOK==1&&Im[2]==0x19))
 705   4                                      {
 706   5                                              BEEP=0;
 707   5                                              delay(50);
 708   5                                              BEEP=1;
 709   5                                              Im[2]=0x00;
 710   5                                              while(!dec);                                                            
 711   5                                              upsmo--;
 712   5                                              num4[4]=upsmo;
 713   5                                              write_rvalue();
 714   5                                      if(uptemp<=0)
 715   5                                      {upsmo=0;}
 716   5                                      }
 717   4                              } 
 718   3                      }
 719   2                      else if(kval==6)
 720   2                      {
 721   3                              if(lofl==1)
 722   3                              {
 723   4                                      write_string(0x80,"Phone number:   ");
 724   4                                      write_string(0xc0,"                ");
 725   4                                      write_com(0x80+0x40+5);    //Ñ¡ÖÐÒº¾§ÆÁÉÏµÄµÚ¶þÐÐµÚÊ®Ò»ÁÐ
 726   4                                      write_date('0'+dianhuahaoma[0]);
 727   4                                      write_date('0'+dianhuahaoma[1]);
 728   4                                      write_date('0'+dianhuahaoma[2]);
 729   4                                      write_date('0'+dianhuahaoma[3]);
 730   4                                      write_date('0'+dianhuahaoma[4]);
 731   4                                      write_date('0'+dianhuahaoma[5]);
 732   4                                      write_date('0'+dianhuahaoma[6]);
 733   4                                      write_date('0'+dianhuahaoma[7]);
 734   4                                      write_date('0'+dianhuahaoma[8]);
 735   4                                      write_date('0'+dianhuahaoma[9]);
 736   4                                      write_date('0'+dianhuahaoma[10]);
C51 COMPILER V9.00   WINDOW_                                                               04/22/2020 14:27:46 PAGE 13  

 737   4                                      write_com(0x0f);//ÉÁË¸
 738   4                                      write_com(0x80+0x40+5);//ÉÁË¸Î»ÖÃ
 739   4                                      lofl=0;
 740   4                              }
 741   3                              if(add==0||(IrOK==1&&Im[2]==0x40))      
 742   3                              {
 743   4                                      delay(20);
 744   4                                      if(add==0||(IrOK==1&&Im[2]==0x40))
 745   4                                      {
 746   5                                              BEEP=0;
 747   5                                              delay(50);
 748   5                                              BEEP=1;
 749   5                                              Im[2]=0x00;
 750   5                                              while(!add);                                                            
 751   5                                              dianhuahaoma[0]++;
 752   5                                              if(dianhuahaoma[0]>9) 
 753   5                                              dianhuahaoma[0]=0;
 754   5                                              write_com(0x80+0x40+5);
 755   5                                              write_date('0'+dianhuahaoma[0]);
 756   5                                              write_com(0x80+0x40+5);
 757   5                                      }
 758   4                              } 
 759   3                              if(dec==0||(IrOK==1&&Im[2]==0x19))      
 760   3                              {
 761   4                                      delay(20);
 762   4                                      if(dec==0||(IrOK==1&&Im[2]==0x19))
 763   4                                      {
 764   5                                              BEEP=0;
 765   5                                              delay(50);
 766   5                                              BEEP=1;
 767   5                                              Im[2]=0x00;
 768   5                                              while(!dec);                                                            
 769   5                                              dianhuahaoma[0]--;
 770   5                                              if(dianhuahaoma[0]<0) 
 771   5                                              dianhuahaoma[0]=9;
 772   5                                              write_com(0x80+0x40+5);
 773   5                                              write_date('0'+dianhuahaoma[0]);
 774   5                                              write_com(0x80+0x40+5);
 775   5                                      }
 776   4                              }
 777   3                      }
 778   2                      else if(kval==7)
 779   2                      {
 780   3                              if(lofl==1)
 781   3                              {
 782   4                                      write_com(0x80+0x40+6);//Î»ÖÃ
 783   4                                      lofl=0;
 784   4                              }
 785   3                              if(add==0||(IrOK==1&&Im[2]==0x40))      
 786   3                              {
 787   4                                      delay(20);
 788   4                                      if(add==0||(IrOK==1&&Im[2]==0x40))
 789   4                                      {
 790   5                                              BEEP=0;
 791   5                                              delay(50);
 792   5                                              BEEP=1;
 793   5                                              Im[2]=0x00;
 794   5                                              while(!add);                                                            
 795   5                                              dianhuahaoma[1]++;
 796   5                                              if(dianhuahaoma[1]>9) 
 797   5                                              dianhuahaoma[1]=0;
 798   5                                              write_com(0x80+0x40+6);
C51 COMPILER V9.00   WINDOW_                                                               04/22/2020 14:27:46 PAGE 14  

 799   5                                              write_date('0'+dianhuahaoma[1]);
 800   5                                              write_com(0x80+0x40+6);
 801   5                                      }
 802   4                              } 
 803   3                              if(dec==0||(IrOK==1&&Im[2]==0x19))      
 804   3                              {
 805   4                                      delay(20);
 806   4                                      if(dec==0||(IrOK==1&&Im[2]==0x19))
 807   4                                      {
 808   5                                              BEEP=0;
 809   5                                              delay(50);
 810   5                                              BEEP=1;
 811   5                                              Im[2]=0x00;
 812   5                                              while(!dec);                                                            
 813   5                                              dianhuahaoma[1]--;
 814   5                                              if(dianhuahaoma[1]<0) 
 815   5                                              dianhuahaoma[1]=9;
 816   5                                              write_com(0x80+0x40+6);
 817   5                                              write_date('0'+dianhuahaoma[1]);
 818   5                                              write_com(0x80+0x40+6);
 819   5                                      }
 820   4                              }
 821   3                      }
 822   2                              
 823   2                      else if(kval==8)
 824   2                      {
 825   3                              if(lofl==1)
 826   3                              {
 827   4                                      write_com(0x80+0x40+7);//Î»ÖÃ
 828   4                                      lofl=0;
 829   4                              }
 830   3                              if(add==0||(IrOK==1&&Im[2]==0x40))      
 831   3                              {
 832   4                                      delay(20);
 833   4                                      if(add==0||(IrOK==1&&Im[2]==0x40))
 834   4                                      {
 835   5                                              BEEP=0;
 836   5                                              delay(50);
 837   5                                              BEEP=1;
 838   5                                              Im[2]=0x00;
 839   5                                              while(!add);                                                            
 840   5                                              dianhuahaoma[2]++;
 841   5                                              if(dianhuahaoma[2]>9) 
 842   5                                              dianhuahaoma[2]=0;
 843   5                                              write_com(0x80+0x40+7);
 844   5                                              write_date('0'+dianhuahaoma[2]);
 845   5                                              write_com(0x80+0x40+7);
 846   5                                      }
 847   4                              } 
 848   3                              if(dec==0||(IrOK==1&&Im[2]==0x19))      
 849   3                              {
 850   4                                      delay(20);
 851   4                                      if(dec==0||(IrOK==1&&Im[2]==0x19))
 852   4                                      {
 853   5                                              BEEP=0;
 854   5                                              delay(50);
 855   5                                              BEEP=1;
 856   5                                              Im[2]=0x00;
 857   5                                              while(!dec);                                                            
 858   5                                              dianhuahaoma[2]--;
 859   5                                              if(dianhuahaoma[2]<0) 
 860   5                                              dianhuahaoma[2]=9;
C51 COMPILER V9.00   WINDOW_                                                               04/22/2020 14:27:46 PAGE 15  

 861   5                                              write_com(0x80+0x40+7);
 862   5                                              write_date('0'+dianhuahaoma[2]);
 863   5                                              write_com(0x80+0x40+7);
 864   5                                      }
 865   4                              }
 866   3                      }
 867   2                      else if(kval==9)
 868   2                      {
 869   3                              if(lofl==1)
 870   3                              {
 871   4                                      write_com(0x80+0x40+8);//Î»ÖÃ
 872   4                                      lofl=0;
 873   4                              }
 874   3                              if(add==0||(IrOK==1&&Im[2]==0x40))      
 875   3                              {
 876   4                                      delay(20);
 877   4                                      if(add==0||(IrOK==1&&Im[2]==0x40))
 878   4                                      {
 879   5                                              BEEP=0;
 880   5                                              delay(50);
 881   5                                              BEEP=1;
 882   5                                              Im[2]=0x00;
 883   5                                              while(!add);                                                            
 884   5                                              dianhuahaoma[3]++;
 885   5                                              if(dianhuahaoma[3]>9) 
 886   5                                              dianhuahaoma[3]=0;
 887   5                                              write_com(0x80+0x40+8);
 888   5                                              write_date('0'+dianhuahaoma[3]);
 889   5                                              write_com(0x80+0x40+8);
 890   5                                      }
 891   4                              } 
 892   3                              if(dec==0||(IrOK==1&&Im[2]==0x19))      
 893   3                              {
 894   4                                      delay(20);
 895   4                                      if(dec==0||(IrOK==1&&Im[2]==0x19))
 896   4                                      {
 897   5                                              BEEP=0;
 898   5                                              delay(50);
 899   5                                              BEEP=1;
 900   5                                              Im[2]=0x00;
 901   5                                              while(!dec);                                                            
 902   5                                              dianhuahaoma[3]--;
 903   5                                              if(dianhuahaoma[3]<0) 
 904   5                                              dianhuahaoma[3]=9;
 905   5                                              write_com(0x80+0x40+8);
 906   5                                              write_date('0'+dianhuahaoma[3]);
 907   5                                              write_com(0x80+0x40+8);
 908   5                                      }
 909   4                              }
 910   3                      }
 911   2                      else if(kval==10)
 912   2                      {
 913   3                              if(lofl==1)
 914   3                              {
 915   4                                      write_com(0x80+0x40+9);//Î»ÖÃ
 916   4                                      lofl=0;
 917   4                              }
 918   3                              if(add==0||(IrOK==1&&Im[2]==0x40))      
 919   3                              {
 920   4                                      delay(20);
 921   4                                      if(add==0||(IrOK==1&&Im[2]==0x40))
 922   4                                      {
C51 COMPILER V9.00   WINDOW_                                                               04/22/2020 14:27:46 PAGE 16  

 923   5                                              BEEP=0;
 924   5                                              delay(50);
 925   5                                              BEEP=1;
 926   5                                              Im[2]=0x00;
 927   5                                              while(!add);                                                            
 928   5                                              dianhuahaoma[4]++;
 929   5                                              if(dianhuahaoma[4]>9) 
 930   5                                              dianhuahaoma[4]=0;
 931   5                                              write_com(0x80+0x40+9);
 932   5                                              write_date('0'+dianhuahaoma[4]);
 933   5                                              write_com(0x80+0x40+9);
 934   5                                      }
 935   4                              } 
 936   3                              if(dec==0||(IrOK==1&&Im[2]==0x19))      
 937   3                              {
 938   4                                      delay(20);
 939   4                                      if(dec==0||(IrOK==1&&Im[2]==0x19))
 940   4                                      {
 941   5                                              BEEP=0;
 942   5                                              delay(50);
 943   5                                              BEEP=1;
 944   5                                              Im[2]=0x00;
 945   5                                              while(!dec);                                                            
 946   5                                              dianhuahaoma[4]--;
 947   5                                              if(dianhuahaoma[4]<0) 
 948   5                                              dianhuahaoma[4]=9;
 949   5                                              write_com(0x80+0x40+9);
 950   5                                              write_date('0'+dianhuahaoma[4]);
 951   5                                              write_com(0x80+0x40+9);
 952   5                                      }
 953   4                              }
 954   3                      }
 955   2                      else if(kval==11)
 956   2                      {
 957   3                              if(lofl==1)
 958   3                              {
 959   4                                      write_com(0x80+0x40+10);//Î»ÖÃ
 960   4                                      lofl=0;
 961   4                              }
 962   3                              if(add==0||(IrOK==1&&Im[2]==0x40))      
 963   3                              {
 964   4                                      delay(20);
 965   4                                      if(add==0||(IrOK==1&&Im[2]==0x40))
 966   4                                      {
 967   5                                              BEEP=0;
 968   5                                              delay(50);
 969   5                                              BEEP=1;
 970   5                                              Im[2]=0x00;
 971   5                                              while(!add);                                                            
 972   5                                              dianhuahaoma[5]++;
 973   5                                              if(dianhuahaoma[5]>9) 
 974   5                                              dianhuahaoma[5]=0;
 975   5                                              write_com(0x80+0x40+10);
 976   5                                              write_date('0'+dianhuahaoma[5]);
 977   5                                              write_com(0x80+0x40+10);
 978   5                                      }
 979   4                              } 
 980   3                              if(dec==0||(IrOK==1&&Im[2]==0x19))      
 981   3                              {
 982   4                                      delay(20);
 983   4                                      if(dec==0||(IrOK==1&&Im[2]==0x19))
 984   4                                      {
C51 COMPILER V9.00   WINDOW_                                                               04/22/2020 14:27:46 PAGE 17  

 985   5                                              BEEP=0;
 986   5                                              delay(50);
 987   5                                              BEEP=1;
 988   5                                              Im[2]=0x00;
 989   5                                              while(!dec);                                                            
 990   5                                              dianhuahaoma[5]--;
 991   5                                              if(dianhuahaoma[5]<0) 
 992   5                                              dianhuahaoma[5]=9;
 993   5                                              write_com(0x80+0x40+10);
 994   5                                              write_date('0'+dianhuahaoma[5]);
 995   5                                              write_com(0x80+0x40+10);
 996   5                                      }
 997   4                              }
 998   3                      }
 999   2                      else if(kval==12)
1000   2                      {
1001   3                              if(lofl==1)
1002   3                              {
1003   4                                      write_com(0x80+0x40+11);//Î»ÖÃ
1004   4                                      lofl=0;
1005   4                              }
1006   3                              if(add==0||(IrOK==1&&Im[2]==0x40))      
1007   3                              {
1008   4                                      delay(20);
1009   4                                      if(add==0||(IrOK==1&&Im[2]==0x40))
1010   4                                      {
1011   5                                              BEEP=0;
1012   5                                              delay(50);
1013   5                                              BEEP=1;
1014   5                                              Im[2]=0x00;
1015   5                                              while(!add);                                                            
1016   5                                              dianhuahaoma[6]++;
1017   5                                              if(dianhuahaoma[6]>9) 
1018   5                                              dianhuahaoma[6]=0;
1019   5                                              write_com(0x80+0x40+11);
1020   5                                              write_date('0'+dianhuahaoma[6]);
1021   5                                              write_com(0x80+0x40+11);
1022   5                                      }
1023   4                              } 
1024   3                              if(dec==0||(IrOK==1&&Im[2]==0x19))      
1025   3                              {
1026   4                                      delay(20);
1027   4                                      if(dec==0||(IrOK==1&&Im[2]==0x19))
1028   4                                      {
1029   5                                              BEEP=0;
1030   5                                              delay(50);
1031   5                                              BEEP=1;
1032   5                                              Im[2]=0x00;
1033   5                                              while(!dec);                                                            
1034   5                                              dianhuahaoma[6]--;
1035   5                                              if(dianhuahaoma[6]<0) 
1036   5                                              dianhuahaoma[6]=9;
1037   5                                              write_com(0x80+0x40+11);
1038   5                                              write_date('0'+dianhuahaoma[6]);
1039   5                                              write_com(0x80+0x40+11);
1040   5                                      }
1041   4                              }
1042   3                      }
1043   2                      else if(kval==13)
1044   2                      {
1045   3                              if(lofl==1)
1046   3                              {
C51 COMPILER V9.00   WINDOW_                                                               04/22/2020 14:27:46 PAGE 18  

1047   4                                      write_com(0x80+0x40+12);//Î»ÖÃ
1048   4                                      lofl=0;
1049   4                              }
1050   3                              if(add==0||(IrOK==1&&Im[2]==0x40))      
1051   3                              {
1052   4                                      delay(20);
1053   4                                      if(add==0||(IrOK==1&&Im[2]==0x40))
1054   4                                      {
1055   5                                              BEEP=0;
1056   5                                              delay(50);
1057   5                                              BEEP=1;
1058   5                                              Im[2]=0x00;
1059   5                                              while(!add);                                                            
1060   5                                              dianhuahaoma[7]++;
1061   5                                              if(dianhuahaoma[7]>9) 
1062   5                                              dianhuahaoma[7]=0;
1063   5                                              write_com(0x80+0x40+12);
1064   5                                              write_date('0'+dianhuahaoma[7]);
1065   5                                              write_com(0x80+0x40+12);
1066   5                                      }
1067   4                              } 
1068   3                              if(dec==0||(IrOK==1&&Im[2]==0x19))      
1069   3                              {
1070   4                                      delay(20);
1071   4                                      if(dec==0||(IrOK==1&&Im[2]==0x19))
1072   4                                      {
1073   5                                              BEEP=0;
1074   5                                              delay(50);
1075   5                                              BEEP=1;
1076   5                                              Im[2]=0x00;
1077   5                                              while(!dec);                                                            
1078   5                                              dianhuahaoma[7]--;
1079   5                                              if(dianhuahaoma[7]<0) 
1080   5                                              dianhuahaoma[7]=9;
1081   5                                              write_com(0x80+0x40+12);
1082   5                                              write_date('0'+dianhuahaoma[7]);
1083   5                                              write_com(0x80+0x40+12);
1084   5                                      }
1085   4                              }
1086   3                      }
1087   2                      else if(kval==14)
1088   2                      {
1089   3                              if(lofl==1)
1090   3                              {
1091   4                                      write_com(0x80+0x40+13);//Î»ÖÃ
1092   4                                      lofl=0;
1093   4                              }
1094   3                              if(add==0||(IrOK==1&&Im[2]==0x40))      
1095   3                              {
1096   4                                      delay(20);
1097   4                                      if(add==0||(IrOK==1&&Im[2]==0x40))
1098   4                                      {
1099   5                                              BEEP=0;
1100   5                                              delay(50);
1101   5                                              BEEP=1;
1102   5                                              Im[2]=0x00;
1103   5                                              while(!add);                                                            
1104   5                                              dianhuahaoma[8]++;
1105   5                                              if(dianhuahaoma[8]>9) 
1106   5                                              dianhuahaoma[8]=0;
1107   5                                              write_com(0x80+0x40+13);
1108   5                                              write_date('0'+dianhuahaoma[8]);
C51 COMPILER V9.00   WINDOW_                                                               04/22/2020 14:27:46 PAGE 19  

1109   5                                              write_com(0x80+0x40+13);
1110   5                                      }
1111   4                              } 
1112   3                              if(dec==0||(IrOK==1&&Im[2]==0x19))      
1113   3                              {
1114   4                                      delay(20);
1115   4                                      if(dec==0||(IrOK==1&&Im[2]==0x19))
1116   4                                      {
1117   5                                              BEEP=0;
1118   5                                              delay(50);
1119   5                                              BEEP=1;
1120   5                                              Im[2]=0x00;
1121   5                                              while(!dec);                                                            
1122   5                                              dianhuahaoma[8]--;
1123   5                                              if(dianhuahaoma[8]<0) 
1124   5                                              dianhuahaoma[8]=9;
1125   5                                              write_com(0x80+0x40+13);
1126   5                                              write_date('0'+dianhuahaoma[8]);
1127   5                                              write_com(0x80+0x40+13);
1128   5                                      }
1129   4                              }
1130   3                      }
1131   2                      else if(kval==15)
1132   2                      {
1133   3                              if(lofl==1)
1134   3                              {
1135   4                                      write_com(0x80+0x40+14);//Î»ÖÃ
1136   4                                      lofl=0;
1137   4                              }
1138   3                              if(add==0||(IrOK==1&&Im[2]==0x40))      
1139   3                              {
1140   4                                      delay(20);
1141   4                                      if(add==0||(IrOK==1&&Im[2]==0x40))
1142   4                                      {
1143   5                                              BEEP=0;
1144   5                                              delay(50);
1145   5                                              BEEP=1;
1146   5                                              Im[2]=0x00;
1147   5                                              while(!add);                                                            
1148   5                                              dianhuahaoma[9]++;
1149   5                                              if(dianhuahaoma[9]>9) 
1150   5                                              dianhuahaoma[9]=0;
1151   5                                              write_com(0x80+0x40+14);
1152   5                                              write_date('0'+dianhuahaoma[9]);
1153   5                                              write_com(0x80+0x40+14);
1154   5                                      }
1155   4                              } 
1156   3                              if(dec==0||(IrOK==1&&Im[2]==0x19))      
1157   3                              {
1158   4                                      delay(20);
1159   4                                      if(dec==0||(IrOK==1&&Im[2]==0x19))
1160   4                                      {
1161   5                                              BEEP=0;
1162   5                                              delay(50);
1163   5                                              BEEP=1;
1164   5                                              Im[2]=0x00;
1165   5                                              while(!dec);                                                            
1166   5                                              dianhuahaoma[9]--;
1167   5                                              if(dianhuahaoma[9]<0) 
1168   5                                              dianhuahaoma[9]=9;
1169   5                                              write_com(0x80+0x40+14);
1170   5                                              write_date('0'+dianhuahaoma[9]);
C51 COMPILER V9.00   WINDOW_                                                               04/22/2020 14:27:46 PAGE 20  

1171   5                                              write_com(0x80+0x40+14);
1172   5                                      }
1173   4                              }
1174   3                      }
1175   2                      else if(kval==16)
1176   2                      {
1177   3                              if(lofl==1)
1178   3                              {
1179   4                                      write_com(0x80+0x40+15);//Î»ÖÃ
1180   4                                      lofl=0;
1181   4                              }
1182   3                              if(add==0||(IrOK==1&&Im[2]==0x40))      
1183   3                              {
1184   4                                      delay(20);
1185   4                                      if(add==0||(IrOK==1&&Im[2]==0x40))
1186   4                                      {
1187   5                                              BEEP=0;
1188   5                                              delay(50);
1189   5                                              BEEP=1;
1190   5                                              Im[2]=0x00;
1191   5                                              while(!add);                                                            
1192   5                                              dianhuahaoma[10]++;
1193   5                                              if(dianhuahaoma[10]>9) 
1194   5                                              dianhuahaoma[10]=0;
1195   5                                              write_com(0x80+0x40+15);
1196   5                                              write_date('0'+dianhuahaoma[10]);
1197   5                                              write_com(0x80+0x40+15);
1198   5                                      }
1199   4                              } 
1200   3                              if(dec==0||(IrOK==1&&Im[2]==0x19))      
1201   3                              {
1202   4                                      delay(20);
1203   4                                      if(dec==0||(IrOK==1&&Im[2]==0x19))
1204   4                                      {
1205   5                                              BEEP=0;
1206   5                                              delay(50);
1207   5                                              BEEP=1;
1208   5                                              Im[2]=0x00;
1209   5                                              while(!dec);                                                            
1210   5                                              dianhuahaoma[10]--;
1211   5                                              if(dianhuahaoma[10]<0) 
1212   5                                              dianhuahaoma[10]=9;
1213   5                                              write_com(0x80+0x40+15);
1214   5                                              write_date('0'+dianhuahaoma[10]);
1215   5                                              write_com(0x80+0x40+15);
1216   5                                      }
1217   4                              }
1218   3                      }
1219   2              
1220   2               //*****ÍË³öÉè¶¨*********               
1221   2                      if(kval>=17)
1222   2                      {
1223   3                              write_com(0x0c);
1224   3                              kval=0;            //ÇåÁãÍË³öÉèÖÃ×´Ì¬
1225   3                              dsflj=1;           //´ò¿ªÖ÷Ò³ÏÔÊ¾²¢¶ÁÈ¡´«¸ÐÆ÷Êý¾Ý
1226   3      //                      lofl=1;
1227   3                              keysw=1;  //ÔÊÐíÊÖ¶¯¿ª¹Ø´°
1228   3                              if(lofl==1)
1229   3                              {
1230   4                                      write_com(0x80);
1231   4                                      for(num=0;num<16;num++)
1232   4                                      {
C51 COMPILER V9.00   WINDOW_                                                               04/22/2020 14:27:46 PAGE 21  

1233   5                                              write_date(logo4[num]);//×ÖÄ»ÏÔÊ¾
1234   5                                      }
1235   4                                      write_com(0x80+0x40);
1236   4                                      for(num=0;num<16;num++)//×ÖÄ»ÏÔÊ¾
1237   4                                      {
1238   5                                              write_date(logo3[num]);
1239   5                                      }
1240   4                                      if(closesw==1)
1241   4                                      {
1242   5                                              write_com(0x80+13);                             
1243   5                                              write_date('O');
1244   5                                              write_date('F');
1245   5                                              write_date('F');
1246   5                                      }
1247   4                                      else
1248   4                                      {
1249   5                                              write_com(0x80+13);                             
1250   5                                              write_date('O');
1251   5                                              write_date('N');
1252   5                                              write_date(' ');
1253   5                                      }
1254   4                                      if(ZD_SD_MODE==0)
1255   4                                      {
1256   5                                              write_com(0x80+0x40+13);                                
1257   5                                              write_date('Z');
1258   5                                              write_date('D');
1259   5                                              write_date(' ');        
1260   5                                      }
1261   4                                      else
1262   4                                      {
1263   5                                              write_com(0x80+0x40+13);                                
1264   5                                              write_date('S');
1265   5                                              write_date('D');
1266   5                                              write_date(' ');
1267   5                                      }
1268   4                                      lofl=0;
1269   4                              }
1270   3                      }
1271   2              }
1272   1      }
1273                  
1274          //²½½øµç»úº¯Êý
1275          void setmoto()
1276          {
1277   1              char num;
1278   1              if(zhenzhuan==1)         //Õý×ª¹Ø´°
1279   1              {
1280   2                      dsflj=0;                //ÕýÔÚ¿ª¹Ø´°Ê±¹Ø±ÕÖ÷½çÃæÏÔÊ¾ºÍ´«¸ÐÆ÷Êý¾Ý¶ÁÈ¡
1281   2                      SETP_MOTOR_REV();        
1282   2                      if(second>=5)
1283   2                      {
1284   3                              jishi=0;
1285   3                              BEEP=0;
1286   3                              zhenzhuan=0;
1287   3                              P1=0X00;
1288   3                              dsflj=1;         //´°×ÓÔËÐÐÍê³Éºó´ò¿ªÖ÷½çÃæÏÔÊ¾ºÍ´«¸ÐÆ÷Êý¾Ý¶ÁÈ¡
1289   3                              opensw=0;         //´ò¿ª
1290   3                              closesw=1;
1291   3                              keysw=1;          //ÔÊÐíÊÖ¶¯¿ª¹Ø´°
1292   3                              menusw=1;        //ÔËÐÐÍê±ÏÖÃ1
1293   3              
1294   3      //                      zhenfl=1;
C51 COMPILER V9.00   WINDOW_                                                               04/22/2020 14:27:46 PAGE 22  

1295   3      //                      fanfl=0;
1296   3      
1297   3                              write_com(0x80);
1298   3                              for(num=0;num<13;num++)
1299   3                              {                                                  //×ÖÄ»ÏÔÊ¾
1300   4                                      write_date(logo4[num]);
1301   4                              }
1302   3                              write_com(0x80+0x40);   //×ÖÄ»ÏÔÊ¾
1303   3                              for(num=0;num<13;num++)
1304   3                              {
1305   4                                      write_date(logo3[num]);
1306   4                              }
1307   3                              write_com(0x80+13);                             
1308   3                              write_date('O');
1309   3                              write_date('F');
1310   3                              write_date('F');
1311   3                              if(ZD_SD_MODE==0)
1312   3                              {
1313   4                                      write_com(0x80+0x40+13);                                
1314   4                                      write_date('Z');
1315   4                                      write_date('D');
1316   4                                      write_date(' ');        
1317   4                              }
1318   3                              else
1319   3                              {
1320   4                                      write_com(0x80+0x40+13);                                
1321   4                                      write_date('S');
1322   4                                      write_date('D');
1323   4                                      write_date(' ');
1324   4                              }
1325   3                              BEEP=1;
1326   3                      }
1327   2              }               
1328   1          if(fanzhuan==1)  //·´×ª¿ª´°
1329   1              {
1330   2                      dsflj=0;          //ÕýÔÚ¿ª¹Ø´°Ê±¹Ø±ÕÖ÷½çÃæÏÔÊ¾ºÍ´«¸ÐÆ÷Êý¾Ý¶ÁÈ¡
1331   2                      SETP_MOTOR_FFW(); 
1332   2                      if(second>=5)
1333   2                      {
1334   3                              jishi=0; 
1335   3                              BEEP=0;
1336   3                              second=0;
1337   3                              P1=0X00;
1338   3      //                      zhenfl=0;
1339   3      //                      fanfl=1;
1340   3                         
1341   3                              fanzhuan=0;
1342   3                              dsflj=1;        //´°×ÓÔËÐÐÍê³Éºó´ò¿ªÖ÷½çÃæÏÔÊ¾ºÍ´«¸ÐÆ÷Êý¾Ý¶ÁÈ¡
1343   3              
1344   3                              opensw=1;
1345   3                              closesw=0;
1346   3                              keysw=1;                 //ÔÊÐíÊÖ¶¯¿ª¹Ø´°
1347   3                              menusw=1;                  //ÔËÐÐÍê±ÏÖÃ1
1348   3                              write_com(0x80);
1349   3                              for(num=0;num<13;num++)  //×ÖÄ»ÏÔÊ¾
1350   3                              {
1351   4                                      write_date(logo4[num]);
1352   4                              }
1353   3                              write_com(0x80+0x40);
1354   3                              for(num=0;num<13;num++)
1355   3                              {                                                         //×ÖÄ»ÏÔÊ¾
1356   4                                      write_date(logo3[num]);
C51 COMPILER V9.00   WINDOW_                                                               04/22/2020 14:27:46 PAGE 23  

1357   4                              }
1358   3                              write_com(0x80+13);                             
1359   3                              write_date('O');
1360   3                              write_date('N');
1361   3                              write_date(' ');
1362   3                              if(ZD_SD_MODE==0)
1363   3                              {
1364   4                                      write_com(0x80+0x40+13);                                
1365   4                                      write_date('Z');
1366   4                                      write_date('D');
1367   4                                      write_date(' ');        
1368   4                              }
1369   3                              else
1370   3                              {
1371   4                                      write_com(0x80+0x40+13);                                
1372   4                                      write_date('S');
1373   4                                      write_date('D');
1374   4                                      write_date(' ');
1375   4                              }
1376   3                              BEEP=1;          
1377   3                      }
1378   2              }
1379   1      }
1380           
1381          void TEMPHRDSPLAY()                 //ÏÔÊ¾¿ÕÆøÎÂÊª¶Èº¯Êý   Ð´Èë1602
1382          { 
1383   1          write_com(0x80+8);                           //ÏÔÊ¾ÎÂ¶È
1384   1              write_date(0x30+U8T_data_H/10);
1385   1              write_date(0x30+U8T_data_H%10);
1386   1      
1387   1          write_com(0x80+0x40+8);                      //ÏÔÊ¾Êª¶È
1388   1              write_date(0x30+U8RH_data_H/10);
1389   1              write_date(0x30+U8RH_data_H%10);
1390   1      
1391   1      }       
1392          
1393          void SMOGDSPLAY()                   //ÏÔÊ¾¿ÕÆø º¯Êý   Ð´Èë1602
1394          {  
1395   1          write_com(0x80+0x40+2);                              
1396   1              write_date(0x30+adc0%1000/100);
1397   1              write_date(0x30+adc0%100/10);
1398   1              write_date(0x30+adc0%10);
1399   1      }
1400          
1401          void BRDSPLAY() 
1402          { 
1403   1          write_com(0x80+2);                  
1404   1              write_date(0x30+adc1%1000/100);
1405   1              write_date(0x30+adc1%100/10);
1406   1              write_date(0x30+adc1%10);
1407   1      }
1408          
1409          void write_rvalue()
1410          {     
1411   1          num4[0]=num4[4]%10;         //ÏÔÊ¾geÎ»  
1412   1              num4[1]=num4[4]%100/10;   //ÏÔÊ¾shiÎ»
1413   1              num4[2]=num4[4]%1000/100;//ÏÔÊ¾°ÙÎ»
1414   1      
1415   1          write_com(0x80+8);                           //ÏÔÊ¾ÎÂ¶È
1416   1              write_date(0x30+num4[2]);
1417   1              write_date(0x30+num4[1]);
1418   1              write_date(0x30+num4[0]);
C51 COMPILER V9.00   WINDOW_                                                               04/22/2020 14:27:46 PAGE 24  

1419   1      }
1420          
1421          /*********************************************************************
1422           *                  C51ÖÐ×Ö·û´®º¯ÊýµÄÀ©³ä                            *
1423           ** º¯ÊýÃû³Æ    : strsearch ()
1424           ** º¯Êý¹¦ÄÜ    : ÔÚÖ¸¶¨µÄÊý×éÀïÁ¬ÐøÕÒµ½ÏàÍ¬µÄÄÚÈÝ
1425           ** Èë¿Ú²ÎÊý   £º ptr2=ÒªÕÒµÄÄÚÈÝ, ptr1 µ±Ç°Êý×é
1426           **** ³ö¿Ú²ÎÊý £º 0-Ã»ÓÐ ÕÒµ½   >1 ²éÕÒµ½
1427           *********************************************************************/
1428          
1429          uchar strsearch(uchar *ptr2,uchar *ptr1_at)//²é×Ö·û´®*ptr2ÔÚ*ptr1ÖÐµÄÎ»ÖÃ
1430          //±¾º¯ÊýÊÇÓÃÀ´¼ì²é×Ö·û´®*ptr2ÊÇ·ñÍêÈ«°üº¬ÔÚ*ptr1ÖÐ
1431          //·µ»Ø:  0  Ã»ÓÐÕÒµ½
1432          //       1-255 ´ÓµÚN¸ö×Ö·û¿ªÊ¼ÏàÍ¬
1433          {
1434   1              uchar i,j,k;
1435   1              if(ptr2[0]==0) return(0);
1436   1              for(i=0,j=0;i<RsBuf_N;i++)
1437   1              {
1438   2              if(ptr1_at[i]==ptr2[j])
1439   2              {//µÚÒ»¸ö×Ö·ûÏàÍ¬
1440   3                      k=i;
1441   3                      do {
1442   4                              if(ptr2[j]=='\0')//±È½ÏÕýÈ·
1443   4                                      return(i+1);               //·µ»ØÖµÊÇÕûÊý£¬²»º¬0
1444   4                              if(ptr1_at[k]!=ptr2[j]) break;
1445   4                              k++;j++ ;        
1446   4                      } while(k<RsBuf_N) ;
1447   3      
1448   3                      j=0;
1449   3              }
1450   2              }
1451   1              return(0);
1452   1      }
1453          
1454          void init()
1455          {                         
1456   1              TMOD=0x11;                                      //¶¨Ê±Æ÷ÉèÖÃ
1457   1              TH0=0; 
1458   1          TL0=0;              //¶¨Ê±ÖÐ¶ÏÖÃÁã
1459   1      
1460   1              TH1=0x3c;                                       //¶¨Ê±Æ÷0ÖÃ³õÖµ 0.05S
1461   1              TL1=0xb0;
1462   1              ET1=1;
1463   1              TR1=1;
1464   1      
1465   1              EA=1;                                           //¿ª×ÜÖÐ¶Ï
1466   1              IT1=1;//ÏÂ½µÑØÓÐÐ§
1467   1              EX1=1;//Íâ²¿ÖÐ¶Ï1¿ª       
1468   1      }
1469          
1470          void uart()
1471          {
1472   1              TMOD=0x20;                                      //¶¨Ê±Æ÷ÉèÖÃ
1473   1              TH1=0xfd;                                       //¶¨Ê±Æ÷0ÖÃ³õÖµ 0.05S
1474   1              TL1=0xfd;
1475   1              ET1=0;
1476   1              TR1=1;
1477   1      
1478   1              SM0=0;      // ÉèÖÃ´®¿ÚµÄ¹¤×÷Ä£Ê½
1479   1              SM1=1;      //·½Ê½1
1480   1      
C51 COMPILER V9.00   WINDOW_                                                               04/22/2020 14:27:46 PAGE 25  

1481   1              REN=1;           // ÔÊÐí´®¿Ú½ÓÊÕÊý¾Ý     
1482   1      
1483   1              ES=1;        // ´®¿ÚÖÐ¶ÏÓ¦Ðí 
1484   1      
1485   1              EA=1;                                           //¿ª×ÜÖÐ¶Ï
1486   1              IT1=0;//ÏÂ½µÑØÓÐÐ§
1487   1              EX1=0;//Íâ²¿ÖÐ¶Ï1¿ª      
1488   1      }
1489          
1490          void SendASC(uchar d)   //´®¿Ú·¢ËÍ×Ö·û
1491          {
1492   1              SBUF=d;                         //Êý¾Ý¸³Öµµ½»º³åÇø
1493   1              while(!TI);                     //·¢ËÍÍê
1494   1      
1495   1              TI=0;                           //ÇåÁã
1496   1      }
1497          
1498          void SendString(uchar *str)       //´®¿Ú·¢ËÍ×Ö·û´®
1499          {
1500   1              while(*str)                               //ÅÐ¶ÏÊÇ·ñ·¢ËÍÍê
1501   1              {
1502   2                      SendASC(*str) ;           //·¢ËÍ×Ö·û
1503   2                      str++;                            //×Ö·ûÎ»ÖÃ¼Ó
1504   2              }
1505   1      }
1506          
1507          void GSM_work()         //·¢ËÍ¶ÌÐÅº¯Êý
1508          {
1509   1              unsigned char send_number;                                //¶¨Òå±äÁ¿ÓÃÓëÐ´Èë½ÓÊÕÊÖ»úºÅÂë
1510   1              uchar k,j;
1511   1              SendString("AT+CMGF=1\r\n");                     //ÉèÖÃÎÄ±¾Ä£Ê½
1512   1              
1513   1              delay(800);                                                      //ÑÓÊ±£¬ÈÃGSMÄ£¿éÓÐÒ»¸ö·´Ó¦Ê±¼ä
1514   1              
1515   1              SendString("AT+CSCS=\"UCS2\"\r\n");              //ÉèÖÃ¶ÌÐÅ¸ñÊ½£¬·¢ËÍºº×ÖÄ£Ê½
1516   1              
1517   1              delay(800);                                                      //ÑÓÊ±
1518   1              
1519   1              RsPoint=0;
1520   1              for(j=0;j<RsBuf_N;j++)
1521   1              {
1522   2                      RsBuf[j]=0;
1523   2              }
1524   1      
1525   1              SendString("AT+CSMP=17,0,2,25\r\n");     //ÉèÖÃ¶ÌÐÅÎÄ±¾Ä£Ê½²ÎÊý£¨¾ßÌåÄÚÈÝ²Î¿¼¿ª·¢×ÊÁÏÄÚµÄÄ£¿é×ÊÁÏ£©
1526   1              
1527   1              delay(300);                                                      //ÑÓÊ±
1528   1              k=0;
1529   1              k=strsearch("OK",RsBuf);                        //·µ»ØOK
1530   1              RsPoint=0;
1531   1              if(k!=0)
1532   1              {
1533   2                      SendString("AT+CMGS="); //ÐÅÏ¢·¢ËÍÖ¸Áî AT+CMGS=//
1534   2                      SendASC('"');                                                                    //ÒýºÅ
1535   2                      for(send_number=0;send_number<11;send_number++)  //ÔÚÃ¿Î»ºÅÂëÇ°¼Ó003
1536   2                      {
1537   3                              SendASC('0');
1538   3                              SendASC('0');
1539   3                              SendASC('3');
1540   3                              SendASC('0'+dianhuahaoma[send_number]);                          //½ÓÊÕÊÖ»úºÅÂë
1541   3                      }     
1542   2                      SendASC('"');                                                                   //ÒýºÅ
C51 COMPILER V9.00   WINDOW_                                                               04/22/2020 14:27:46 PAGE 26  

1543   2                      SendASC('\r');                  //·¢ËÍ»Ø³µÖ¸Áî//
1544   2                      SendASC('\n');                  //·¢ËÍ»»ÐÐÖ¸Áî//
1545   2                      
1546   2                      delay(800);                             //ÑÓÊ±
1547   2              
1548   2                      SendString(somebody);           //·¢ËÍ¶ÌÐÅÄÚÈÝ
1549   2              
1550   2                      delay(800);                             //ÑÓÊ±
1551   2                      
1552   2                      SendASC(0x1a);                          //È·¶¨·¢ËÍ¶ÌÐÅ
1553   2              }
1554   1      }
1555          
1556          void main()//Ö÷º¯Êý
1557          {
1558   1              uchar num;
1559   1              uchar j;
1560   1              init1602();
1561   1              uart();
1562   1              delay(5000);                                                      //ÑÓÊ±
1563   1              SendString("AT\r\n");
1564   1          delay(800);                                                   //ÑÓÊ±
1565   1              SendString("AT\r\n");
1566   1          delay(800);                                                   //ÑÓÊ±
1567   1              SendString("ati\r\n");
1568   1          delay(800);                                                   //ÑÓÊ±
1569   1              SendString("ati\r\n");
1570   1          delay(800);                                                   //ÑÓÊ±
1571   1          SendString("ATH\r\n");
1572   1          delay(800);                                                   //ÑÓÊ±
1573   1              SendString("AT+IPR=9600\r\n");
1574   1          delay(800);                                                   //ÑÓÊ±
1575   1              RsPoint=0;
1576   1              for(j=0;j<RsBuf_N;j++)
1577   1              {
1578   2                      RsBuf[j]=0;
1579   2              }
1580   1              delay(10000);                                                     //ÑÓÊ±
1581   1      
1582   1              SendString("AT\r\n");
1583   1          delay(800);                                                   //ÑÓÊ±
1584   1              SendString("ati\r\n");
1585   1          delay(800);                                                   //ÑÓÊ±
1586   1          SendString("ATH\r\n");
1587   1          delay(800);                                                   //ÑÓÊ±
1588   1          SendString("AT+CMGF=1\r\n");
1589   1          delay(800);                                                   //ÑÓÊ±
1590   1              SendString("AT+CNMI=2,1,0,0,0\r\n");
1591   1          delay(800);                                                   //ÑÓÊ±
1592   1              SendString("AT+CSCS=\"UCS2\"\r\n");             
1593   1              delay(800);                                                       //ÑÓÊ±
1594   1              SendString("AT+CSMP=17,0,2,25\r\n");            
1595   1              delay(800);                                                       //ÑÓÊ±
1596   1              SendString("AT+CMGL=\"REC UNREAD\",0\r\n");
1597   1              delay(800);                                                       //ÑÓÊ±
1598   1      
1599   1              //***************************************************
1600   1         write_com(0x80);
1601   1         for(num=0;num<16;num++)      //¿ª»ú×ÖÄ»
1602   1              {
1603   2                      write_date(logo6[num]);
1604   2              }
C51 COMPILER V9.00   WINDOW_                                                               04/22/2020 14:27:46 PAGE 27  

1605   1      
1606   1              write_com(0x80+0x40);
1607   1              for(num=0;num<16;num++)
1608   1              {
1609   2                      write_date(logo10[num]);//¿ª»ú×ÖÄ»
1610   2              }
1611   1      
1612   1              init();
1613   1              init_eeprom();  //¿ªÊ¼³õÊ¼»¯±£´æµÄÊý¾Ý
1614   1              zhenzhuan=1;//ÉÏµç¹ØÕý×ª
1615   1              fanzhuan=0;//ÉÏµç·´×ª¹Ø±Õ¹Ø´°
1616   1              dsflj=1;        // ÏÔÊ¾´ò¿ª             
1617   1              keysw=0;        //³õÊ¼×´Ì¬ ÖÃ0 ²»ÔÊÐíÊÖ¶¯¿ª´°¹Ø´°
1618   1              menusw=1;        //³õÊ¼×´Ì¬ÔËÐÐÍê±Ï
1619   1              second=0;
1620   1      
1621   1              adc0 = ADC0832(1,0);  //²î·ÖÄ£Ê½£¬CH0-CH1
1622   1              adc1 = ADC0832(1,1);  //²î·ÖÄ£Ê½£¬CH0-CH1
1623   1      
1624   1              while(1)//´óÑ­»·                   
1625   1              {
1626   2                      keyscn();
1627   2                      setmoto();
1628   2                      if (dsflj==1)
1629   2                      {
1630   3                              if(flag_celiang==1)
1631   3                              {
1632   4                                      RH(); //DHT11 µ÷ÓÃ 
1633   4                                      TEMPHRDSPLAY(); 
1634   4                                      adc0 = ADC0832(1,0);  //²î·ÖÄ£Ê½£¬CH0-CH1 ÑÌÎí
1635   4                                      SMOGDSPLAY();
1636   4                                      adc1 = ADC0832(1,1);  //²î·ÖÄ£Ê½£¬CH0-CH1 ¹âÏß
1637   4                                      BRDSPLAY();
1638   4                                      flag_celiang=0; 
1639   4                              }
1640   3                              if(ZD_SD_MODE==0)               //×Ô¶¯Ä£Ê½
1641   3                              {
1642   4                                      if(closesw==1)    //¹Ø±Õ×´Ì¬
1643   4                                      {        //¹âÏß³¬ÉÏÏÞ   Óë   ÎÂ¶ÈÐ¡ÓÚ    Óë    Êª¶ÈÐ¡ÓÚ         »ò       ÑÌÎí´óÓÚ    Ã»±¨¾¯µÄ×´Ì¬
1644   5                                              if(((adc1> kwbrig&&U8T_data_H<uptemp&&U8RH_data_H<uphum)||adc0>upsmo)&&befl==0)//Èç¹û¼ÊÁÁ¶ÈÐ¡ÓÚÉè¶¨Öµ
             - kai
1645   5                                              {        //¿ª´°
1646   6                                                              write_com(0x80);
1647   6                                                              for(num=0;num<16;num++) //¿ª»ú×ÖÄ»
1648   6                                                              {
1649   7                                                                      write_date(logo5[num]); //¿ª´°
1650   7                                                              }
1651   6                                                      
1652   6                                                              write_com(0x80+0x40);
1653   6                                                              for(num=0;num<16;num++)
1654   6                                                              {
1655   7                                                                      write_date(logo10[num]);//¿ª»ú×ÖÄ»
1656   7                                                              }
1657   6                                                              closesw=0;
1658   6                                                              zhenzhuan=0;
1659   6                                                              fanzhuan=1;
1660   6                                                              second=0;
1661   6                                                              jishi=1;
1662   6                                                              if(adc0>upsmo)
1663   6                                                              befl=1;
1664   6                                              }                                               
1665   5                                      }
C51 COMPILER V9.00   WINDOW_                                                               04/22/2020 14:27:46 PAGE 28  

1666   4                                      if(opensw==1)      //´ò¿ª×´Ì¬
1667   4                                      {       //ÑÌÎíÐ¡ÓÚ        Óë      Êª¶È´óÓÚ    »ò    ÎÂ¶È´óÓÚ   »ò  ¹âÏßÐ¡ÓÚÏÂÏÞ
1668   5                                              if((adc0<=upsmo&&(U8RH_data_H>uphum||U8T_data_H>uptemp||adc1<dwbrig))||IR==0)            //¹Ø´°
1669   5                                              {
1670   6                                                      if(IR==0)
1671   6                                                      {
1672   7                                                              write_com(0x80);
1673   7                                                              for(num=0;num<16;num++) //¿ª»ú×ÖÄ»
1674   7                                                              {
1675   8                                                                      write_date(logo17[num]);
1676   8                                                              }
1677   7                                                      
1678   7                                                              write_com(0x80+0x40);
1679   7                                                              for(num=0;num<16;num++)
1680   7                                                              {
1681   8                                                                      write_date(logo10[num]);//¿ª»ú×ÖÄ»
1682   8                                                              }
1683   7                                                              uart();
1684   7                                                              GSM_work();                                       //·¢ËÍ¶ÌÐÅº¯Êý
1685   7                                                              init();
1686   7                                                              befl=1;
1687   7                                                      }
1688   6                                                      write_com(0x80);
1689   6                                                      for(num=0;num<16;num++) //¿ª»ú×ÖÄ»
1690   6                                                      {
1691   7                                                              write_date(logo6[num]);
1692   7                                                      }
1693   6                                              
1694   6                                                      write_com(0x80+0x40);
1695   6                                                      for(num=0;num<16;num++)
1696   6                                                      {
1697   7                                                              write_date(logo10[num]);//¿ª»ú×ÖÄ»
1698   7                                                      }
1699   6                                                      opensw=0;
1700   6                                                      fanzhuan=0;
1701   6                                                      zhenzhuan=1;
1702   6                                                      second=0;
1703   6                                                      jishi=1;
1704   6                                              }
1705   5                                              if(adc0>upsmo)
1706   5                                              befl=1;  
1707   5                                      }
1708   4                              }
1709   3                      }
1710   2              }
1711   1      }
1712          
1713          //  Í¨Ñ¶ÖÐ¶Ï½ÓÊÕ³ÌÐò   ÖÐ¶Ïº¯ÊýÎÞ·µ»ØÖµ
1714          void uart_rx(void)  interrupt 4 using 3   //·ÅÔÚÕâÀï ºÍ·ÅÔÚmain£¨£©ÀïÃæÊÇÒ»ÑùµÄ
1715          {
1716   1              ES=0;
1717   1              if(RI) //±ØÐëÅÐ¶ÏRIÊÇ·ñÎª1
1718   1          {
1719   2              RI=0;
1720   2              RsBuf[RsPoint++]=SBUF;
1721   2                      if(RsPoint>=RsBuf_N)
1722   2                      RsPoint=0;
1723   2          }
1724   1              ES=1;
1725   1      }
1726          
1727          void time1() interrupt 3        //¶¨Ê±ÖÐ¶Ï×Ó³ÌÐò
C51 COMPILER V9.00   WINDOW_                                                               04/22/2020 14:27:46 PAGE 29  

1728          {
1729   1              uchar count0;
1730   1              TH1=0x3c;                                                       //ÖØ¸³³õÖµ
1731   1              TL1=0xb0;
1732   1              count0++;
1733   1              con++;
1734   1      
1735   1              if(count0>=20)
1736   1              {
1737   2                      count0=0;
1738   2                      if(jishi==1)
1739   2              second++;
1740   2                      if(flag_celiang==0)
1741   2                      flag_celiang=1;
1742   2              }                       
1743   1          if(befl==1)    //Æô¶¯±¨¾¯
1744   1              {
1745   2                      if(con>=10)
1746   2                      {
1747   3                              con=0;
1748   3                      BEEP=~BEEP;                     
1749   3                      }       
1750   2              }        
1751   1      }
1752          
1753          //*********************************ÖÐ¶Ï·þÎñº¯Êý**************************************
1754          // Ò£¿Ø ½âÂë º¯Êý ½ÓÊÕÍ· ½ÓÍâ²¿ ÖÐ¶Ï¿Ú P3.3
1755          /************************************************************************/      
1756          //Íâ²¿ÖÐ¶Ï½âÂë³ÌÐò
1757          void intersvr1() interrupt 2
1758          {
1759   1              TR0=1;
1760   1          Tc=TH0*256+TL0; //¶¨Ê±Æ÷Çå¿ÕÖ»¼ÇTC Öµ                                              //ÌáÈ¡ÖÐ¶ÏÊ±¼ä¼ä¸ôÊ
             -±³¤
1761   1          TH0=0; 
1762   1          TL0=0;              //¶¨Ê±ÖÐ¶ÏÖØÐÂÖÃÁã
1763   1      
1764   1              if((Tc>Imin)&&(Tc<Imax))//Æô¶¯ÂëÅÐ¶¨ Á½¸öÊ±¼ä¶Ô±È0.9MS  
1765   1              {  
1766   2              m=0;
1767   2              f=1;
1768   2              return;
1769   2              }       //ÕÒµ½ÆôÊ¼Âë
1770   1              
1771   1              if(f==1)
1772   1              {
1773   2              if(Tc>Inum1&&Tc<Inum3) //ÅÐ¶¨ÊÇ0¸Ã»¹ÊÇ1 ÊÇ0 1.125MS ÊÇ1  2.25MS
1774   2                      {
1775   3                              Im[m/8]=Im[m/8]>>1|0x80; m++;  //´æ0
1776   3                      }
1777   2                      if(Tc>Inum2&&Tc<Inum1) 
1778   2              {
1779   3                              Im[m/8]=Im[m/8]>>1; m++; //     ´æ1
1780   3                      }
1781   2                      if(m==32)       //32Î»´æ´¢Íê±Ï
1782   2                      {
1783   3                              m=0;  
1784   3                              f=0;
1785   3                              if(Im[2]==~Im[3])  //·´Âë¼ì²é
1786   3                              {        
1787   4                                      IrOK=1;         //OK Íê³É
1788   4                                              TR0=0;
C51 COMPILER V9.00   WINDOW_                                                               04/22/2020 14:27:46 PAGE 30  

1789   4                              }
1790   3                              else IrOK=0;   //È¡ÂëÍê³ÉºóÅÐ¶Ï¶ÁÂëÊÇ·ñÕýÈ·
1791   3                      }       //×¼±¸¶ÁÏÂÒ»Âë
1792   2              }       
1793   1      }
1794          /***************************END***********************/


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   7110    ----
   CONSTANT SIZE    =    462    ----
   XDATA SIZE       =    150    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     60      11
   IDATA SIZE       =   ----    ----
   BIT SIZE         =     13       2
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
